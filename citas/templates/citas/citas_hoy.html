<!-- citas/templates/citas/citas_hoy.html -->
{% extends 'citas/base_citas.html' %}

{% block title %}Citas de Hoy - Veterinaria{% endblock %}

{% block content %}
<div class="card">
    <h2> Citas Programadas para Hoy ({{ fecha|date:"d/m/Y" }})</h2>
    
    {% if citas %}
    <div class="table-responsive">
        <table style="width: 100%; border-collapse: collapse; margin-top: 20px;">
            <thead>
                <tr style="background: #4CAF50; color: white;">
                    <th style="padding: 12px; text-align: left;">Hora</th>
                    <th style="padding: 12px; text-align: left;">Mascota</th>
                    <th style="padding: 12px; text-align: left;">Propietario</th>
                    <th style="padding: 12px; text-align: left;">Servicio</th>
                    <th style="padding: 12px; text-align: left;">Estado</th>
                    <th style="padding: 12px; text-align: left;">Acciones</th>
                </tr>
            </thead>
            <tbody>
                {% for cita in citas %}
                <tr style="border-bottom: 1px solid #ddd; background: {% cycle '#f9f9f9' 'white' %}">
                    <td style="padding: 12px;">{{ cita.hora_cita }}</td>
                    <td style="padding: 12px;">
                        <strong>{{ cita.mascota }}</strong><br>
                        <small>{{ cita.tipo_mascota }}</small>
                    </td>
                    <td style="padding: 12px;">
                        {{ cita.propietario.get_full_name|default:cita.propietario.username }}<br>
                        <small>{{ cita.telefono }}</small>
                    </td>
                    <td style="padding: 12px;">{{ cita.get_tipo_servicio_display }}</td>
                    <td style="padding: 12px;">
                        <span style="
                            padding: 4px 8px;
                            border-radius: 4px;
                            font-size: 0.85rem;
                            {% if cita.estado == 'pendiente' %}background: #fff3cd; color: #856404;
                            {% elif cita.estado == 'confirmada' %}background: #d4edda; color: #155724;
                            {% elif cita.estado == 'completada' %}background: #cce5ff; color: #004085;
                            {% else %}background: #f8d7da; color: #721c24;{% endif %}
                        ">
                            {{ cita.get_estado_display }}
                        </span>
                    </td>
                    <td style="padding: 12px;">
                        <div style="display: flex; gap: 5px;">
                            <a href="{% url 'citas:detalle_cita' cita.pk %}" 
                               class="btn" 
                               style="padding: 5px 10px; font-size: 0.85rem;">
                                ğŸ‘ï¸ Ver
                            </a>
                            <form method="post" action="{% url 'citas:cambiar_estado_cita' cita.pk %}" 
                                  style="display: inline;">
                                {% csrf_token %}
                                <select name="estado" 
                                        onchange="this.form.submit()"
                                        style="padding: 5px; border-radius: 4px;">
                                    {% for value, label in cita.ESTADO_CHOICES %}
                                    <option value="{{ value }}" {% if cita.estado == value %}selected{% endif %}>
                                        {{ label }}
                                    </option>
                                    {% endfor %}
                                </select>
                            </form>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div style="text-align: center; padding: 40px; background: #f8f9fa; border-radius: 8px; margin: 20px 0;">
        <p style="font-size: 1.2rem; color: #666;">ğŸ‰ Â¡No hay citas programadas para hoy!</p>
        <p>Puedes revisar las citas pendientes o el historial completo.</p>
    </div>
    {% endif %}
    
    <div style="margin-top: 30px; display: flex; gap: 10px; justify-content: center;">
        <a href="{% url 'citas:citas_pendientes' %}" class="btn">ğŸ“‹ Ver Citas Pendientes</a>
        {% if user.es_admin %}
        <a href="{% url 'citas:historial_citas' %}" class="btn">ğŸ“Š Ver Historial Completo</a>
        {% endif %}
        <a href="{% url 'citas:lista_citas' %}" class="btn">â†©ï¸ Volver a Mis Citas</a>
    </div>
</div>
{% endblock %}